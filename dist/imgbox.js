!function(e){function t(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,o){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=1)}([function(e,t,i){"use strict";t.a={name:"ElxImgbox",props:{},data:function(){return{options:{uploadUrl:"",listUrl:"",multiple:!0,limit:10,onSelect:null,enableUpload:!0,maxSize:2,data:{},withCredentials:!0},isLoading:!0,visible:!0,activeTab:"pick",selectedImgs:[],uploadSuccessCount:0,fixThumbInterval:null,imgRes:{list:[],total:0}}},methods:{onClickImage:function(e){var t=this.selectedImgIndex(e);return t>-1?(e.selected=!1,void this.selectedImgs.splice(t,1)):this.options.limit>0&&this.selectedImgs.length>=this.options.limit?void this.onExceedTip():(this.options.multiple||this.onCancelAll(),e.selected=!0,void this.selectedImgs.push(JSON.parse(JSON.stringify(e))))},loadImgList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=this.options.listUrl;if(!i)throw new Error("listUrl is required");this.isLoading=!0,axios.get(i,{params:{page:t,rows:15,_r:Math.random()}}).then(function(t){var i=t.data,o=[];e.imgRes.total=parseInt(i.total);var n=0;for(var l in i.list){if(++n>15)break;var s=i.list[l];if("string"!=typeof s.thumb)throw new Error("图片数据必须包含'thumb'属性！");"string"!=typeof s.name&&(s.name=s.thumb.substr(s.thumb.lastIndexOf("/")+1)),"string"!=typeof s.label&&(s.label=""),s.selected=e.selectedImgIndex(s)>-1,o.push(s)}e.imgRes.list=o,e.isLoading=!1})},selectedImgIndex:function(e){for(var t=0;t<this.selectedImgs.length;t++){if(this.selectedImgs[t].url==e.url)return t}return-1},onPageNumChange:function(e){this.loadImgList(e)},onCancelAll:function(){this.selectedImgs=[];for(var e in this.imgRes.list)this.imgRes.list[e].selected=!1},onConfirmSelect:function(){if("function"!=typeof this.options.onSelect)return ELEMENT.Message.error("请先设置回调函数"),!1;this.options.onSelect(JSON.parse(JSON.stringify(this.selectedImgs))),this.visible=!1,this.reset()},handleConfirmUpload:function(){this.$refs.upload.submit()},onProgress:function(e,t,i){},onChange:function(e,t){!this.options.multiple&&t.length>1&&t.splice(0,t.length-2)},typeTip:function(){return"仅支持 jpg/png/gif 图片"},sizeTip:function(){return"大小不能超过 "+this.options.maxSize+"M"},beforeUpload:function(e){var t="image/jpeg"===e.type,i="image/png"===e.type,o="image/gif"===e.type,n=e.size/1048576<this.options.maxSize;return t||i||o?!!n||(ELEMENT.Message.error(this.sizeTip()),!1):(ELEMENT.Message.error(this.typeTip()),!1)},onUploadError:function(e,t,i){ELEMENT.Message.info("服务器打了个盹^_^"),console.log(e)},onUploadSuccess:function(e,t,i){console.log(e,t,i);var o=e.uploadfile_response;this.selectedImgs.length>=this.options.limit&&this.selectedImgs.splice(1,1),this.selectedImgs.push(o),this.onConfirmSelect(),this.uploadSuccessCount++,i.length===this.uploadSuccessCount&&(this.visible=!1,this.reset())},onExceedTip:function(){ELEMENT.Message.warning("最多只能选择"+this.options.limit+"张图片")},onPreview:function(e){window.open(e.url)},onRemove:function(e){for(var t=this.$refs.upload.uploadFiles,i=0;i<t.length;i++)t[i].uid===e.uid&&t.splice(i,1)},reset:function(){void 0!==this.$refs.upload&&this.$refs.upload.clearFiles(),this.uploadSuccessCount=0,this.onCancelAll()}},mounted:function(){this.loadImgList()},computed:{}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(2),n={install:function(e){var t=e.extend(o.a);e.elxImgbox=e.prototype.$elxImgbox=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments[1],o=new t;if(void 0===i)o.selectedImgs={};else{o.selectedImgs=JSON.parse(JSON.stringify(i));for(var n=0;n<o.selectedImgs.length;n++)o.selectedImgs[n].selected=!0}for(var l in e)o.options[l]=e[l];if(!o.$el){var s=o.$mount();document.querySelector("body").appendChild(s.$el)}return"upload"!==o.activeTab||o.options.enableUpload||(o.activeTab="pick"),o.visible=!0,o}}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(n),t.default=n},function(e,t,i){"use strict";function o(e){i(3)}var n=i(0),l=i(9),s=i(8),a=o,r=s(n.a,l.a,!1,a,null,null);t.a=r.exports},function(e,t,i){var o=i(4);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i(6)("ee7bc650",o,!0,{})},function(e,t,i){t=e.exports=i(5)(!1),t.push([e.i,'.elx-imgbox .el-badge{vertical-align:bottom}.elx-imgbox .el-dialog{width:720px}.elx-imgbox .el-dialog .el-dialog__header{border-bottom:1px solid #e8e8e8}.elx-imgbox .el-dialog .el-dialog__body{padding:0;background:#f6f6f6}.elx-imgbox .el-tabs .el-tabs__header{margin-right:0;margin-top:5px}.elx-imgbox .el-tabs .el-tabs__header .el-tabs__nav-wrap:after{background:#f6f6f6}.elx-imgbox .el-tabs .el-tabs__item.is-active{background:#fff}.elx-imgbox .el-tabs .el-tabs--left .el-tabs__nav-wrap{padding-top:15px}.elx-imgbox .el-tabs .el-tabs__content{height:560px;background:#fff}.elx-imgbox .elx-foot{padding:15px 0 0 10px}.elx-imgbox .elx-foot .el-button{margin:0 0 0 10px}.elx-imgbox .pick-block{position:relative}.elx-imgbox .pick-block .img-list-loading{position:absolute;z-index:9;left:0;right:0;width:100%;height:450px;background:#fff;text-align:center}.elx-imgbox .pick-block .img-list-loading .el-icon-loading{font-size:50px;color:#409eff;line-height:250px}.elx-imgbox .pick-block .img-list{padding:10px;height:433px}.elx-imgbox .pick-block .img-list .img-item{float:left;margin:10px;width:100px;cursor:pointer;position:relative;font-size:12px}.elx-imgbox .pick-block .img-list .img-item img{width:100px;height:100px;display:block}.elx-imgbox .pick-block .img-list .img-item .title{line-height:24px;height:24px;display:block;overflow:hidden;background:#f6f6f6;padding:0 5px}.elx-imgbox .pick-block .img-list .img-item .label{position:absolute;z-index:9;left:0;bottom:24px;width:100%;height:21px;line-height:21px;text-align:center;color:#fff}.elx-imgbox .pick-block .img-list .img-item .label:after{content:" ";position:absolute;left:0;bottom:0;width:100%;height:21px;background:#000;opacity:.3;z-index:-1}.elx-imgbox .pick-block .img-list .img-item .selected{position:absolute;right:-3px;top:-3px;width:100%;height:100%;border:3px solid #409eff;border-radius:3px;text-align:right}.elx-imgbox .pick-block .img-list .img-item .selected .icon{background:#409eff;text-align:center;height:24px;width:24px;line-height:24px;display:inline-block;font-size:16px;color:#fff;border-radius:0 0 0 3px;position:absolute;right:0;top:0}.elx-imgbox .pick-block .img-list:after{content:" ";display:table;height:0;clear:both;visibility:hidden}.elx-imgbox .pick-block .el-pagination{background:#f9f9f9;position:relative;padding:5px;margin:0 24px 0 20px;text-align:right;float:none}.elx-imgbox .pick-block .el-pagination *{background:none}.elx-imgbox .upload-block .upload-img-preview{padding:20px}.elx-imgbox .upload-block .upload-img-preview .el-upload--picture-card,.elx-imgbox .upload-block .upload-img-preview .el-upload-list--picture-card .el-upload-list__item,.elx-imgbox .upload-block .upload-img-preview .el-upload-list--picture-card .el-upload-list__item .wp{width:90px;height:90px;line-height:98px;background-size:cover;background-position:50% 50%}.elx-imgbox .upload-block .upload-img-preview .el-upload--picture-card a,.elx-imgbox .upload-block .upload-img-preview .el-upload-list--picture-card .el-upload-list__item .wp a,.elx-imgbox .upload-block .upload-img-preview .el-upload-list--picture-card .el-upload-list__item a{color:#fff}.elx-imgbox .upload-block .upload-img-preview .el-upload-list--picture-card .el-upload-list__item-status-label i{margin-top:12px;vertical-align:top}.elx-imgbox .upload-block .upload-tip{padding:0 20px;font-size:13px;color:#999}.elx-imgbox .upload-block .upload-title{font-size:16px;color:#666;padding:20px 0 0 20px}',""])},function(e,t){function i(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var l=o(n);return[i].concat(n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"})).concat([l]).join("\n")}return[i].join("\n")}function o(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var o=i(t,e);return t[2]?"@media "+t[2]+"{"+o+"}":o}).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},n=0;n<this.length;n++){var l=this[n][0];"number"==typeof l&&(o[l]=!0)}for(n=0;n<e.length;n++){var s=e[n];"number"==typeof s[0]&&o[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),t.push(s))}},t}},function(e,t,i){function o(e){for(var t=0;t<e.length;t++){var i=e[t],o=p[i.id];if(o){o.refs++;for(var n=0;n<o.parts.length;n++)o.parts[n](i.parts[n]);for(;n<i.parts.length;n++)o.parts.push(l(i.parts[n]));o.parts.length>i.parts.length&&(o.parts.length=i.parts.length)}else{for(var s=[],n=0;n<i.parts.length;n++)s.push(l(i.parts[n]));p[i.id]={id:i.id,refs:1,parts:s}}}}function n(){var e=document.createElement("style");return e.type="text/css",d.appendChild(e),e}function l(e){var t,i,o=document.querySelector("style["+h+'~="'+e.id+'"]');if(o){if(f)return m;o.parentNode.removeChild(o)}if(x){var l=g++;o=u||(u=n()),t=s.bind(null,o,l,!1),i=s.bind(null,o,l,!0)}else o=n(),t=a.bind(null,o),i=function(){o.parentNode.removeChild(o)};return t(e),function(o){if(o){if(o.css===e.css&&o.media===e.media&&o.sourceMap===e.sourceMap)return;t(e=o)}else i()}}function s(e,t,i,o){var n=i?"":o.css;if(e.styleSheet)e.styleSheet.cssText=v(t,n);else{var l=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(l,s[t]):e.appendChild(l)}}function a(e,t){var i=t.css,o=t.media,n=t.sourceMap;if(o&&e.setAttribute("media",o),b.ssrId&&e.setAttribute(h,t.id),n&&(i+="\n/*# sourceURL="+n.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c=i(7),p={},d=r&&(document.head||document.getElementsByTagName("head")[0]),u=null,g=0,f=!1,m=function(){},b=null,h="data-vue-ssr-id",x="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());e.exports=function(e,t,i,n){f=i,b=n||{};var l=c(e,t);return o(l),function(t){for(var i=[],n=0;n<l.length;n++){var s=l[n],a=p[s.id];a.refs--,i.push(a)}t?(l=c(e,t),o(l)):l=[];for(var n=0;n<i.length;n++){var a=i[n];if(0===a.refs){for(var r=0;r<a.parts.length;r++)a.parts[r]();delete p[a.id]}}}};var v=function(){var e=[];return function(t,i){return e[t]=i,e.filter(Boolean).join("\n")}}()},function(e,t){e.exports=function(e,t){for(var i=[],o={},n=0;n<t.length;n++){var l=t[n],s=l[0],a=l[1],r=l[2],c=l[3],p={id:e+":"+n,css:a,media:r,sourceMap:c};o[s]?o[s].parts.push(p):i.push(o[s]={id:s,parts:[p]})}return i}},function(e,t){e.exports=function(e,t,i,o,n,l){var s,a=e=e||{},r=typeof e.default;"object"!==r&&"function"!==r||(s=e,a=e.default);var c="function"==typeof a?a.options:a;t&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0),i&&(c.functional=!0),n&&(c._scopeId=n);var p;if(l?(p=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(l)},c._ssrRegister=p):o&&(p=o),p){var d=c.functional,u=d?c.render:c.beforeCreate;d?(c._injectStyles=p,c.render=function(e,t){return p.call(t),u(e,t)}):c.beforeCreate=u?[].concat(u,p):[p]}return{esModule:s,exports:a,options:c}}},function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"elx-imgbox",attrs:{title:"图片管理器",visible:e.visible,id:"elx-imgbox",top:"5vh"},on:{"update:visible":function(t){e.visible=t}}},[i("el-tabs",{attrs:{"tab-position":"left"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[i("el-tab-pane",{staticClass:"pick-block",attrs:{label:"选择图片",name:"pick"}},[e.isLoading?i("div",{staticClass:"img-list-loading"},[i("div",{staticClass:"el-icon-loading"})]):e._e(),e._v(" "),i("div",{staticClass:"elx-main img-list"},e._l(e.imgRes.list,function(t){return i("div",{staticClass:"img-item",on:{click:function(i){return e.onClickImage(t)}}},[i("div",{staticClass:"thumb-wp"},[i("img",{attrs:{src:t.thumb,alt:"img.name"}})]),e._v(" "),i("div",{staticClass:"title"},[e._v(e._s(t.name))]),e._v(" "),t.label?i("div",{staticClass:"label"},[e._v(e._s(t.label))]):e._e(),e._v(" "),t.selected?i("span",{staticClass:"selected"},[i("span",{staticClass:"icon el-icon-check"})]):e._e()])}),0),e._v(" "),i("el-pagination",{attrs:{layout:"total, prev, pager, next",total:e.imgRes.total},on:{"current-change":e.onPageNumChange}}),e._v(" "),i("div",{staticClass:"elx-foot"},[i("el-badge",{staticClass:"item",attrs:{value:e.selectedImgs.length}},[i("el-button",{attrs:{type:"primary",size:"medium",disabled:0==e.selectedImgs.length},on:{click:e.onConfirmSelect}},[e._v("确定选择")])],1),e._v(" "),e.options.enableUpload?i("el-button",{attrs:{type:"primary",size:"medium",plain:""},on:{click:function(t){e.activeTab="upload"}}},[e._v("上传图片")]):e._e(),e._v(" "),e.selectedImgs.length>0?i("el-button",{attrs:{type:"text"},on:{click:e.onCancelAll}},[e._v("取消已选")]):e._e()],1)],1),e._v(" "),e.options.enableUpload?i("el-tab-pane",{staticClass:"upload-block",attrs:{label:"上传图片",name:"upload"}},[i("div",{staticClass:"elx-main"},[i("div",{staticClass:"upload-title"},[e._v("请选择本地图片上传：")]),e._v(" "),i("el-upload",{ref:"upload",staticClass:"upload-img-preview",attrs:{"list-type":"picture-card",accept:"image/*","with-credentials":e.options.withCredentials,action:e.options.uploadUrl,"auto-upload":!1,multiple:e.options.multiple,limit:e.options.limit,"before-upload":e.beforeUpload,"on-change":e.onChange,"on-progress":e.onProgress,"on-success":e.onUploadSuccess,"on-error":e.onUploadError,"on-exceed":e.onExceedTip},scopedSlots:e._u([{key:"file",fn:function(t){var o=t.file;return i("div",{staticClass:"wp",style:"background-image: url("+o.url+")"},[i("span",{staticClass:"el-upload-list__item-actions"},[i("a",{staticClass:"el-upload-list__item-preview",attrs:{href:o.url,target:"_blank"}},[i("i",{staticClass:"el-icon-zoom-in"})]),e._v(" "),e.disabled?e._e():i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.onRemove(o)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,2564728287)},[i("i",{staticClass:"el-icon-plus"})]),e._v(" "),i("div",{staticClass:"upload-tip"},[e._v(e._s(e.typeTip())+"，"+e._s(e.sizeTip()))]),e._v(" "),i("div",{staticClass:"elx-foot"},[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleConfirmUpload}},[e._v("确定上传")])],1)],1)]):e._e()],1)],1)},n=[],l={render:o,staticRenderFns:n};t.a=l}]);
//# sourceMappingURL=imgbox.js.map